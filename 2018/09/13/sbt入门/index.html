<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>sbt安装与仓库设置 | sustcoder</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="spark,sbt," />
  

  <meta name="description" content="sbt的仓库配置">
<meta name="keywords" content="stb,scala,maven,仓库,阿里仓库">
<meta property="og:type" content="article">
<meta property="og:title" content="sbt安装与仓库设置">
<meta property="og:url" content="https://sustcoder.github.io/2018/09/13/sbt入门/index.html">
<meta property="og:site_name" content="sustcoder">
<meta property="og:description" content="sbt的仓库配置">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-11-30T07:15:38.862Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sbt安装与仓库设置">
<meta name="twitter:description" content="sbt的仓库配置">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cben" rel="stylesheet">


  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/blog/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境"><span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#软件"><span class="toc-text">软件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装sbt"><span class="toc-text">安装sbt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置文件"><span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sbt仓库设置"><span class="toc-text">sbt仓库设置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#方案一"><span class="toc-text">方案一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方案二"><span class="toc-text">方案二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#添加依赖build-sbt"><span class="toc-text">添加依赖build.sbt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#下载依赖"><span class="toc-text">下载依赖</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#问题处理"><span class="toc-text">问题处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#版本不兼容"><span class="toc-text">版本不兼容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jdk不兼容"><span class="toc-text">jdk不兼容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件下载缓慢"><span class="toc-text">文件下载缓慢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改sbt数据源"><span class="toc-text">修改sbt数据源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#不靠谱方案"><span class="toc-text">不靠谱方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改成阿里云数据源后依旧下载失败"><span class="toc-text">修改成阿里云数据源后依旧下载失败</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看配置参数是否生效"><span class="toc-text">查看配置参数是否生效</span></a></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-sbt入门" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">sbt安装与仓库设置</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2018.09.13</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>liyz</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/spark/">spark</a>
  </span>



      
        <span>
          <i class="icon-comment"></i>
          <a href="https://sustcoder.github.io//2018/09/13/sbt入门/#disqus_thread"></a>
        </span>
      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul>
<li><code>java 1.8</code></li>
<li><code>scala 2.12.6</code></li>
<li><code>sbt 1.2.1</code></li>
<li><code>idea2.18.3</code><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2></li>
<li><code>idea sbt</code>插件</li>
<li><code>idea scala</code>插件</li>
<li>sbt安装包 <code>https://sbt-downloads.cdnedge.bluemix.net/releases/v1.2.1/sbt-1.2.1.msi</code>,非必须，可直接使用idea的sbt插件做对应配置<h2 id="安装sbt"><a href="#安装sbt" class="headerlink" title="安装sbt"></a>安装sbt</h2></li>
</ul>
<ol>
<li>新建sbt安装路径，注意：<strong>sbt安装路径中不能含有空格和中文</strong>，将<code>sbt-1.2.1.msi</code>安装到此路径。</li>
<li>配置环境变量</li>
</ol>
<ul>
<li>新建变量sbt<blockquote>
<p>SBT_HOME  D:\ProgramFile\sbt</p>
</blockquote>
</li>
<li>添加变量到path中<blockquote>
<p> %SBT_HOME%bin;</p>
</blockquote>
</li>
</ul>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>修改文件<code>onf/sbtconfig.txt</code>，添加以下内容</p>
<blockquote>
<p>-Dfile.encoding=UTF8</p>
</blockquote>
<h2 id="sbt仓库设置"><a href="#sbt仓库设置" class="headerlink" title="sbt仓库设置"></a>sbt仓库设置</h2><h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><p>直接修改sbt的jar里面的配置文件。<code>windows</code>下可通过360压缩替换掉<code>jar</code>包里面的文件。</p>
<ol>
<li>找到sbt安装目录<code>D:\ProgramFile\sbt\bin</code></li>
<li>备份<code>sbt-launch.jar</code>为<code>sbt-launch.jar.bak</code></li>
<li>解压<code>sbt-launch.jar.bak</code>,打开个<code>sbt.boot.properties</code>文件</li>
<li><p>在<code>[repositories]</code>里面的<code>local</code>下面添加以下数据源</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alirepo1:https://maven.aliyun.com/repository/central</span><br><span class="line">alirepo2:https://maven.aliyun.com/repository/jcenter</span><br><span class="line">alirepo3:https://maven.aliyun.com/repository/public</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用360压缩打开<code>sbt-launch.jar</code>,找到<code>sbt.boot.properties</code>文件并替换</p>
</li>
</ol>
<h3 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h3><p>配置sbt的数据源，让其优先加载我们配置的数据源</p>
<ol>
<li>在<code>D:\ProgramFile\sbt\conf</code>目录下，新建文件<code>repository.properties</code></li>
<li><p>在<code>repository.properties</code>中添加以下内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[repositories]</span><br><span class="line">local</span><br><span class="line">alirepo1:https://maven.aliyun.com/repository/central</span><br><span class="line">alirepo2:https://maven.aliyun.com/repository/jcenter</span><br><span class="line">alirepo3:https://maven.aliyun.com/repository/public</span><br></pre></td></tr></table></figure>
</li>
<li><p>在<code>conf/sbtconfig.txt</code>中添加<code>repository.properties</code>文件路径</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-Dsbt.repository.config=D:/ProgramFile/sbt/conf/repository.properties</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="添加依赖build-sbt"><a href="#添加依赖build-sbt" class="headerlink" title="添加依赖build.sbt"></a>添加依赖build.sbt</h2><p>在项目中找到<code>build.sbt</code>文件，此类似于<code>maven</code>中的<code>pom</code>文件<br>添加<code>spark-core</code>和<code>spark-sql</code>等的依赖<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name := &quot;sbt-test&quot; // 项目名称</span><br><span class="line"></span><br><span class="line">version := &quot;0.1&quot; // 项目版本号</span><br><span class="line"></span><br><span class="line">scalaVersion := &quot;2.11.12&quot; // scala版本号</span><br><span class="line"></span><br><span class="line">// 依赖</span><br><span class="line">libraryDependencies ++= Seq(</span><br><span class="line">  &quot;org.apache.spark&quot;  %%  &quot;spark-core&quot;    % &quot;2.2.0&quot;,</span><br><span class="line">  &quot;org.apache.spark&quot;  %%  &quot;spark-sql&quot;     % &quot;2.2.0&quot;,</span><br><span class="line">  &quot;com.typesafe.scala-logging&quot; % &quot;scala-logging-slf4j_2.11&quot; % &quot;latest.integration&quot;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h2 id="下载依赖"><a href="#下载依赖" class="headerlink" title="下载依赖"></a>下载依赖</h2><p>通过以下方式打开执行命令窗口</p>
<ul>
<li>在<code>build.sbt</code>同级目录下打开<code>cmd</code>窗口</li>
<li>在<code>idea</code>中打开<code>Termail</code>窗口</li>
</ul>
<p>下载或更新jar</p>
<blockquote>
<p>sbt update</p>
</blockquote>
<p>编译文件</p>
<blockquote>
<p>sbt compile</p>
</blockquote>
<p>打包</p>
<blockquote>
<p>sbt package</p>
</blockquote>
<h1 id="问题处理"><a href="#问题处理" class="headerlink" title="问题处理"></a>问题处理</h1><h2 id="版本不兼容"><a href="#版本不兼容" class="headerlink" title="版本不兼容"></a>版本不兼容</h2><h3 id="jdk不兼容"><a href="#jdk不兼容" class="headerlink" title="jdk不兼容"></a>jdk不兼容</h3><ul>
<li><code>idea2018</code>需要<code>jdk8</code>以上</li>
<li><code>spark2.0</code>需要<code>jdk8</code>以上<h2 id="文件下载缓慢"><a href="#文件下载缓慢" class="headerlink" title="文件下载缓慢"></a>文件下载缓慢</h2><code>idea</code>控制台<code>build</code>界面一直在转圈,并提示<code>dump project structure from sbt</code></li>
</ul>
<p>这里需要注意，在<code>Intellij Idea</code>启动时，会执行<code>dump project structure from sbt</code>的操作，也就是把sbt所需要的项目结构从远程服务器拉取到本地，在本地会生成sbt所需要的项目结构。由于是从国外的远程服务器下载，所以，这个过程很慢，笔者电脑上运行了15分钟。这个过程没有结束之前，上图中的<code>File-&gt;New</code>弹出的子菜单是找不到<code>Scala Class</code>这个选项的。所以，一定要等<code>dump project structure from sbt</code>的操作全部执行结束以后，再去按照上图操作来新建<code>Scala Class</code>文件。</p>
<h2 id="修改sbt数据源"><a href="#修改sbt数据源" class="headerlink" title="修改sbt数据源"></a>修改sbt数据源</h2><h3 id="不靠谱方案"><a href="#不靠谱方案" class="headerlink" title="不靠谱方案"></a>不靠谱方案</h3><ol>
<li>将数据源改为<code>maven.oschina.com</code>。此数据源已经失效</li>
<li>将<code>sbt.boot.properties</code>中的<code>https</code>改为<code>http</code>。未生效</li>
<li>在<code>sbt</code>的<code>vm</code>中配置<code>-Dsbt.override.build.repos=true</code>。此方法效果和<code>-Dsbt.repository.config=D:/ProgramFile/sbt/conf/repository.properties</code>一致，前提是需要配置数据源</li>
<li>最笨方案，下载jar包，放到本地仓库<code>C:\Users\sustcoder\.ivy2\cache</code></li>
</ol>
<h3 id="修改成阿里云数据源后依旧下载失败"><a href="#修改成阿里云数据源后依旧下载失败" class="headerlink" title="修改成阿里云数据源后依旧下载失败"></a>修改成阿里云数据源后依旧下载失败</h3><ul>
<li>配置的<code>sbt</code>版本在阿里云的仓库中没有。排查办法：可以去<code>maven.aliyun.com</code>去查看对应版本pom文件是否存在</li>
<li>在阿里云上找到了对应版本但依旧保持。注意查看日志信息中下载的jar包路径含有<code>_2.10</code>类似的字样，比如在<code>build.sbt</code>中配置的是<code>&quot;org.apache.spark&quot;  %%  &quot;spark-sql&quot;     % &quot;2.2.0&quot;</code>,但是日志里面是<code>[warn]  :: com.typesafe.scala-logging#scala-sql_2.10;2.1.2: not found</code>,这个是因为sbt里面的<code>%%</code>代表sbt默认会拼接上scala的版本号在pom文件上，下载最适合的jar包，可以将<code>%%</code>改为<code>%</code>，即改为<code>&quot;org.apache.spark&quot;  %  &quot;spark-sql&quot;     % &quot;2.2.0&quot;</code>,注意区别：仅仅是少了一个百分号。</li>
<li>执行<code>sbt-shell</code>会走默认的仓库配置，需要在sbt的vm参数中配置<code>-Dsbt.override.build.repos=true</code> ????<h2 id="查看配置参数是否生效"><a href="#查看配置参数是否生效" class="headerlink" title="查看配置参数是否生效"></a>查看配置参数是否生效</h2>可在日志控制台查看第一行日志，查看配置参数是否生效，走的是自己安装的sbt还是idea的插件,如下日志，在<code>sbtconfig.txt</code>中配置信息会进行加载<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;C:\Program Files\Java\jdk8\bin\java.exe&quot; -agentlib:jdwp=transport=dt_socket,address=localhost:58502,suspend=n,server=y -Xdebug -server -Xmx1536M </span><br><span class="line">-Dsbt.repository.config=D:/develop/sbt/conf/repository.properties -Didea.managed=true -Dfile.encoding=UTF-8 </span><br><span class="line">-Didea.runid=2018.2 -jar D:\ProgramFile\sbt\bin\sbt-launch.jar idea-shell</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>参考链接</strong></p>
<p><a href="https://www.scala-sbt.org/0.13/docs/Proxy-Repositories.html" target="_blank" rel="noopener">https://www.scala-sbt.org/0.13/docs/Proxy-Repositories.html</a></p>
<p><a href="https://segmentfault.com/a/1190000002484978" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002484978</a></p>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持sustcoder</div>
        <ul>
        
          <li class="item">
            
              <span>微信扫一扫</span>
            
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            
              <span>支付宝扫一扫</span>
            
            <img src="/images/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2018/09/10/hello-world/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2018/09/18/windows下JDK版本切换脚本/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>





   
      <div class="git"></div>
   
</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/blog/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'forsigner';
    
    var disqus_url = 'https://sustcoder.github.io/2018/09/13/sbt入门/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//forsigner.disqus.com/count.js" async></script>



    

    
    

    

    
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
