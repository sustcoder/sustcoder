<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>BitMap的JAVA实现 | sustcoder</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="algorithm,java," />
  

  <meta name="description" content="用java实现bitMap">
<meta name="keywords" content="java,bitMap">
<meta property="og:type" content="article">
<meta property="og:title" content="BitMap的JAVA实现">
<meta property="og:url" content="https://sustcoder.github.io/2018/10/23/bitMap-explain-and-use/index.html">
<meta property="og:site_name" content="sustcoder">
<meta property="og:description" content="用java实现bitMap">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://sustblog.oss-cn-beijing.aliyuncs.com/blog/2018/algorithm/bitMap.jpg">
<meta property="og:updated_time" content="2018-11-23T01:11:49.133Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BitMap的JAVA实现">
<meta name="twitter:description" content="用java实现bitMap">
<meta name="twitter:image" content="https://sustblog.oss-cn-beijing.aliyuncs.com/blog/2018/algorithm/bitMap.jpg">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cben" rel="stylesheet">


  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/blog/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#相关概念"><span class="toc-text">相关概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基础类型"><span class="toc-text">基础类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#位运算符"><span class="toc-text">位运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进制转换"><span class="toc-text">进制转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BitMap实现原理"><span class="toc-text">BitMap实现原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BitMap源码"><span class="toc-text">BitMap源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BitMap应用"><span class="toc-text">BitMap应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BitMap问题"><span class="toc-text">BitMap问题</span></a></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-bitMap-explain-and-use" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">BitMap的JAVA实现</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2018.10.23</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>liyz</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/algorithm/">algorithm</a>
  </span>



      
        <span>
          <i class="icon-comment"></i>
          <a href="https://sustcoder.github.io//2018/10/23/bitMap-explain-and-use/#disqus_thread"></a>
        </span>
      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <h2 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h2><h3 id="基础类型"><a href="#基础类型" class="headerlink" title="基础类型"></a>基础类型</h3><p>在java中：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">byte  -&gt;   8 bits  --&gt;1字节</span><br><span class="line">char  -&gt;   16 bit  --&gt;2字节</span><br><span class="line">short -&gt;   16 bits --&gt;2字节</span><br><span class="line">int   -&gt;   32 bits --&gt;4字节</span><br><span class="line">float -&gt;   32 bits --&gt;4字节</span><br><span class="line">long  -&gt;   64 bits --&gt;8字节</span><br></pre></td></tr></table></figure>
<h3 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h3><p>在java中，int数据底层以补码形式存储。int型变量使用32bit存储数据，其中最高位是符号位，0表示正数，1表示负数，可通过<code>Integer.toBinaryString()</code>转换为bit字符串，</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 若最高的几位为0则不输出这几位，从为1的那一位开始输出</span><br><span class="line">System.out.println(Integer.toBinaryString(10)); </span><br><span class="line">System.out.println(Integer.toBinaryString(-10));</span><br><span class="line">// 会输出（手工排版过，以下的输出均会被手工排版）：</span><br><span class="line">                            1010</span><br><span class="line">11111111111111111111111111110110</span><br></pre></td></tr></table></figure>
<p><strong>左移&lt;&lt;</strong></p>
<blockquote>
<p>5&lt;&lt;2=20</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">首先会将5转为2进制表示形式: 0000 0000 0000 0000 0000 0000 0000 0101  </span><br><span class="line">然后左移2位后，低位补0：    0000 0000 0000 0000 0000 0000 0001 0100  </span><br><span class="line">换算成10进制为20</span><br></pre></td></tr></table></figure>
<p><strong>右移&gt;&gt;</strong></p>
<blockquote>
<p>5&gt;&gt;2=1</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">还是先将5转为2进制表示形式：0000 0000 0000 0000 0000 0000 0000 0101 </span><br><span class="line">然后右移2位，高位补0：     0000 0000 0000 0000 0000 0000 0000 0001</span><br><span class="line">换算成十进制后是1</span><br></pre></td></tr></table></figure>
<p><strong>无符号右移&gt;&gt;&gt;</strong></p>
<blockquote>
<p>5&gt;&gt;&gt;3</p>
</blockquote>
<p>我们知道在Java中int类型占32位，可以表示一个正数，也可以表示一个负数。正数换算成二进制后的最高位为0，负数的二进制最高为为1。<strong>对于2进制补码的加法运算，和平常的计算一样，而且符号位也参与运算，不过最后只保留32位。</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-5换算成二进制： 1111 1111 1111 1111 1111 1111 1111 1011</span><br><span class="line">-5右移3位：     1111 1111 1111 1111 1111 1111 1111 1111   // (用1进行补位，结果为-1)</span><br><span class="line">-5无符号右移3位: 0001 1111 1111 1111 1111 1111 1111 1111   // (用0进行补位,结果536870911 )</span><br></pre></td></tr></table></figure>
<p><strong>位与</strong>&amp;</p>
<p>第一个操作数的的第n位于第二个操作数的第n位如果都是1，那么结果的第n为也为1，否则为0</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5转换为二进制：0000 0000 0000 0000 0000 0000 0000 0101</span><br><span class="line">3转换为二进制：0000 0000 0000 0000 0000 0000 0000 0011</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">1转换为二进制：0000 0000 0000 0000 0000 0000 0000 0001</span><br></pre></td></tr></table></figure>
<p><strong>位或|</strong></p>
<p>第一个操作数的的第n位于第二个操作数的第n位只要有一个为1则为1，否则为0</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5转换为二进制：0000 0000 0000 0000 0000 0000 0000 0101</span><br><span class="line">3转换为二进制：0000 0000 0000 0000 0000 0000 0000 0011</span><br><span class="line">-------------------------------------------------------------------------------------</span><br><span class="line">6转换为二进制：0000 0000 0000 0000 0000 0000 0000 0111</span><br></pre></td></tr></table></figure>
<p>对于移位运算，例如将x左移/右移n位，如果x是byte、short、char、int，<strong>n会先模32（即n=n%32），然后再进行移位操作</strong>。可以这样解释：int类型为32位,移动32位（或以上）没有意义。</p>
<p>同理若x是long，n=n%64。</p>
<p><strong>左移和右移代替乘除</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a=a*4;</span><br><span class="line">b=b/4;</span><br></pre></td></tr></table></figure>
<p>　可以改为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a=a&lt;&lt;2;</span><br><span class="line">b=b&gt;&gt;2;</span><br></pre></td></tr></table></figure>
<p>　　<strong>说明：</strong><br>　　除2 = 右移1位 乘2 = 左移1位<br>　　除4 = 右移2位 乘4 = 左移2位<br>　　除8 = 右移3位 乘8 = 左移3位<br>　　… …<br>　　类比十进制中的满十进一，向左移动小数点后，数字就会缩小十倍，在二进制中满二进一，进行右移一次相当于缩小了2两倍，右移两位相当于缩小了4倍，右移三位相当于缩小了8倍。通常如果需要乘以或除以2的n次方，都可以用移位的方法代替。 　　<br>　　<strong>实际上，只要是乘以或除以一个整数，均可以用移位的方法得到结果，</strong>如：<br>　　a=a<em>9<br>　　分析a</em>9可以拆分成a<em>(8+1)即a</em>8+a<em>1, 因此可以改为： a=(a&lt;&lt;3)+a<br>　　a=a</em>7<br>　　分析a<em>7可以拆分成a</em>(8-1)即a<em>8-a</em>1, 因此可以改为： a=(a&lt;&lt;3)-a<br>　　关于除法读者可以类推, 此略。<br>　　【注意】由于+/-运算符优先级比移位运算符高，所以在写公式时候一定要记得添加括号，不可以 a = a*12 等价于 a = a&lt;&lt;3 +a &lt;&lt;2; 要写成a = (a&lt;&lt;3)+(a &lt;&lt;2 )。</p>
<p><strong>与运算代替取余</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">31转换为二进制：011111,0,31</span><br><span class="line">32转换为二进制：100010 与31取交集的结果是：10转换为十进制为2</span><br><span class="line">31转换为二进制：100001 与31取交集的结果是：01转换为十进制为1</span><br><span class="line">30转换为二进制：011110 与31取交集的结果是：11110转换为十进制为30</span><br><span class="line">29转换为二进制：011101 与31取交集的结果是：11101转换为十进制为29</span><br><span class="line">33转换为二进制：100001 与31取交集的结果是：1转换为十进制为1</span><br></pre></td></tr></table></figure>
<p>31转换为二进制后，低位值全部为1，高位全为0。所以和其进行与运算，高位和0与，结果是0，相当于将高位全部截取，截取后的结果肯定小于等于31，地位全部为1，与1与值为其本身，所以相当于对数进行了取余操作。</p>
<h3 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h3><ul>
<li><code>0x</code>开头表示16进制，例如：0x2表示：2，0x2f表示48</li>
<li><code>0</code>开头表示8进制，例如：02表示：2,010表示：8</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Integer.toHexString(int i)   // 十进制转成十六进制</span><br><span class="line">Integer.toOctalString(int i) // 十进制转成八进制 </span><br><span class="line">Integer.toBinaryString(int i)// 十进制转成二进制</span><br><span class="line">Integer.valueOf(m,n).toString() // 把n进制的m转换为10进制</span><br></pre></td></tr></table></figure>
<h2 id="BitMap实现原理"><a href="#BitMap实现原理" class="headerlink" title="BitMap实现原理"></a>BitMap实现原理</h2><p>在java中，一个int类型占32个字节，我们用一个int数组来表示时未new int[32],总计占用内存32*32bit,现假如我们用int字节码的每一位表示一个数字的话，那么32个数字只需要一个int类型所占内存空间大小就够了，这样在大数据量的情况下会节省很多内存。</p>
<p>具体思路：</p>
<p>   1个int占4字节即4*8=32位，那么我们只需要申请一个int数组长度为 int tmp[1+N/32]即可存储完这些数据，其中N代表要进行查找的总数，tmp中的每个元素在内存在占32位可以对应表示十进制数0~31,所以可得到BitMap表:</p>
<p>tmp[0]:可表示0~31</p>
<p>tmp[1]:可表示32~63</p>
<p>tmp[2]可表示64~95</p>
<p>…….</p>
<p>那么接下来就看看十进制数如何转换为对应的bit位：</p>
<p>假设这40亿int数据为：6,3,8,32,36,……，那么具体的BitMap表示为：</p>
<p><img src="https://sustblog.oss-cn-beijing.aliyuncs.com/blog/2018/algorithm/bitMap.jpg" alt="bitMap.jpg"></p>
<p>如何判断int数字在tmp数组的哪个下标，这个其实可以通过直接除以32取整数部分，例如：整数8除以32取整等于0，那么8就在tmp[0]上。另外，我们如何知道了8在tmp[0]中的32个位中的哪个位，这种情况直接mod上32就ok，又如整数8，在tmp[0]中的第8 mod上32等于8，那么整数8就在tmp[0]中的第八个bit位（从右边数起）。</p>
<h2 id="BitMap源码"><a href="#BitMap源码" class="headerlink" title="BitMap源码"></a>BitMap源码</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">long</span> length;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[] bitsMap;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span>[] BIT_VALUE = &#123;<span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000010</span>, <span class="number">0x00000020</span>,</span><br><span class="line">           <span class="number">0x00000040</span>, <span class="number">0x00000080</span>, <span class="number">0x00000100</span>, <span class="number">0x00000200</span>, <span class="number">0x00000400</span>, <span class="number">0x00000800</span>, <span class="number">0x00001000</span>, <span class="number">0x00002000</span>, <span class="number">0x00004000</span>,</span><br><span class="line">           <span class="number">0x00008000</span>, <span class="number">0x00010000</span>, <span class="number">0x00020000</span>, <span class="number">0x00040000</span>, <span class="number">0x00080000</span>, <span class="number">0x00100000</span>, <span class="number">0x00200000</span>, <span class="number">0x00400000</span>, <span class="number">0x00800000</span>,</span><br><span class="line">           <span class="number">0x01000000</span>, <span class="number">0x02000000</span>, <span class="number">0x04000000</span>, <span class="number">0x08000000</span>, <span class="number">0x10000000</span>, <span class="number">0x20000000</span>, <span class="number">0x40000000</span>, <span class="number">0x80000000</span>&#125;;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">BitMap2</span><span class="params">(<span class="keyword">long</span> length)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.length = length;</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 根据长度算出，所需数组大小</span></span><br><span class="line"><span class="comment">        * 当 length%32=0 时大小等于</span></span><br><span class="line"><span class="comment">        * = length/32</span></span><br><span class="line"><span class="comment">        * 当 length%32&gt;0 时大小等于</span></span><br><span class="line"><span class="comment">        * = length/32+l</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       bitsMap = <span class="keyword">new</span> <span class="keyword">int</span>[(<span class="keyword">int</span>) (length &gt;&gt; <span class="number">5</span>) + ((length &amp; <span class="number">31</span>) &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>)];</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> n 要被设置的值为n</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setN</span><span class="params">(<span class="keyword">long</span> n)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (n &lt; <span class="number">0</span> || n &gt; length) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"length value "</span>+n+<span class="string">" is  illegal!"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 求出该n所在bitMap的下标,等价于"n/5"</span></span><br><span class="line">       <span class="keyword">int</span> index = (<span class="keyword">int</span>) n&gt;&gt;<span class="number">5</span>;</span><br><span class="line">       <span class="comment">// 求出该值的偏移量(求余),等价于"n%31"</span></span><br><span class="line">       <span class="keyword">int</span> offset = (<span class="keyword">int</span>) n &amp; <span class="number">31</span>;</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 等价于</span></span><br><span class="line"><span class="comment">        * int bits = bitsMap[index];</span></span><br><span class="line"><span class="comment">        * bitsMap[index]=bits| BIT_VALUE[offset];</span></span><br><span class="line"><span class="comment">        * 例如,n=3时,设置byte第4个位置为1 （从0开始计数，bitsMap[0]可代表的数为：0~31，从左到右每一个bit位表示一位数）</span></span><br><span class="line"><span class="comment">        * bitsMap[0]=00000000 00000000 00000000 00000000  |  00000000 00000000 00000000 00001000=00000000 00000000 00000000 00000000 00001000</span></span><br><span class="line"><span class="comment">        * 即: bitsMap[0]= 0 | 0x00000008 = 3</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 例如,n=4时,设置byte第5个位置为1</span></span><br><span class="line"><span class="comment">        * bitsMap[0]=00000000 00000000 00000000 00001000  |  00000000 00000000 00000000 00010000=00000000 00000000 00000000 00000000 00011000</span></span><br><span class="line"><span class="comment">        * 即: bitsMap[0]=3 | 0x00000010 = 12</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       bitsMap[index] |= BIT_VALUE[offset];</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取值N是否存在</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> 1：存在，0：不存在</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">isExist</span><span class="params">(<span class="keyword">long</span> n)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (n &lt; <span class="number">0</span> || n &gt; length) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"length value illegal!"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">int</span> index = (<span class="keyword">int</span>) n&gt;&gt;<span class="number">5</span>;</span><br><span class="line">       <span class="keyword">int</span> offset = (<span class="keyword">int</span>) n &amp; <span class="number">31</span>;</span><br><span class="line">       <span class="keyword">int</span> bits = (<span class="keyword">int</span>) bitsMap[index];</span><br><span class="line">       <span class="comment">// System.out.println("n="+n+",index="+index+",offset="+offset+",bits="+Integer.toBinaryString(bitsMap[index]));</span></span><br><span class="line">       <span class="keyword">return</span> ((bits &amp; BIT_VALUE[offset])) &gt;&gt;&gt; offset;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="BitMap应用"><a href="#BitMap应用" class="headerlink" title="BitMap应用"></a>BitMap应用</h2><ol>
<li>BitMap小小变种:2-BitMap。</li>
</ol>
<p>看个小场景：在3亿个整数中找出不重复的整数，限制内存不足以容纳3亿个整数。</p>
<p>对于这种场景我可以采用2-BitMap来解决，即为每个整数分配2bit，用不同的0、1组合来标识特殊意思，如00表示此整数没有出现过，01表示出现一次，11表示出现过多次，就可以找出重复的整数了，其需要的内存空间是正常BitMap的2倍，为：3亿*2/8/1024/1024=71.5MB。</p>
<p>具体的过程如下：</p>
<p>   扫描着3亿个整数，组BitMap，先查看BitMap中的对应位置，如果00则变成01，是01则变成11，是11则保持不变，当将3亿个整数扫描完之后也就是说整个BitMap已经组装完毕。最后查看BitMap将对应位为11的整数输出即可。</p>
<ol start="2">
<li>已知某个文件内包含一些电话号码，每个号码为8位数字，统计不同号码的个数。</li>
</ol>
<p>8位最多99 999 999，大概需要99m个bit，大概10几m字节的内存即可。 （可以理解为从0-99 999 999的数字，每个数字对应一个Bit位，所以只需要99M个Bit==1.2MBytes，这样，就用了小小的1.2M左右的内存表示了所有的8位数的电话）</p>
<h2 id="BitMap问题"><a href="#BitMap问题" class="headerlink" title="BitMap问题"></a>BitMap问题</h2><p>BitMap 的思想在面试的时候还是可以用来解决不少问题的，然后在很多系统中也都会用到，算是一种不错的解决问题的思路。</p>
<p>但是 BitMap 也有一些局限，因此会有其它一些基于 BitMap 的算法出现来解决这些问题。</p>
<ul>
<li>数据碰撞。比如将字符串映射到 BitMap 的时候会有碰撞的问题，那就可以考虑用 Bloom Filter 来解决，Bloom Filter 使用多个 Hash 函数来减少冲突的概率。</li>
<li>数据稀疏。又比如要存入(10,8887983,93452134)这三个数据，我们需要建立一个 99999999 长度的 BitMap ，但是实际上只存了3个数据，这时候就有很大的空间浪费，碰到这种问题的话，可以通过引入 Roaring BitMap 来解决。</li>
</ul>
<p><strong>参考链接</strong></p>
<p> <a href="http://www.infoq.com/cn/articles/the-secret-of-bitmap" target="_blank" rel="noopener">Bitmap的秘密</a></p>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持sustcoder</div>
        <ul>
        
          <li class="item">
            
              <span>微信扫一扫</span>
            
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            
              <span>支付宝扫一扫</span>
            
            <img src="/images/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2018/10/20/spark env building process/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2018/11/14/Data consistency  in microservices/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>





   
      <div class="git"></div>
   
</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/blog/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'forsigner';
    
    var disqus_url = 'https://sustcoder.github.io/2018/10/23/bitMap-explain-and-use/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//forsigner.disqus.com/count.js" async></script>



    

    
    

    

    
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
